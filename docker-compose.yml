version: "3.8"

# notes:
# "ports SOME_PUBLICPORT:SOME_INTERNALPORT" sets up a forwarding from host (aka ouside world) to internal docker network
# "expose SOME_INTERNALPORT" is only for documentation / metadata on the container. set this to the port that the service is using.
# communicate between services with protocol://servicename:INTERNALPORT eg http://api:3002 or mysql://someusername:somepassword@db:3306/db

services:
  db:
    image: andersgee/http-mysql8
    restart: unless-stopped
    env_file:
      - ./.env
    expose:
      - 3000
      - 3306
      - 33060
    ports:
      - $DB_HTTP_PORT:3000
      - $DB_PORT:3306
    build:
      context: .
      dockerfile: ./Dockerfile
    volumes:
      - db-data:/var/lib/mysql
      #- ./my.cnf:/etc/my.cnf

volumes:
  db-data:
